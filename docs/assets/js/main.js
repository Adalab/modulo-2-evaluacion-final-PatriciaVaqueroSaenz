"use strict";console.log(">> Ready :)");const searchButton=document.querySelector(".js-searchButton"),resultList=document.querySelector(".js-main-list"),favoriteList=document.querySelector(".main__list-favorite");let showsName,showsImage,showsImageMedium,showId,globalData,favorites=[];const defaultImage="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";function conectToApi(){const e=document.querySelector(".js-searchInput").value;fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{globalData=e,localStorage.setItem("globalData",JSON.stringify(e)),printShows(globalData)}),printFavoriteList(globalData)}function printShows(e){resultList.innerHTML="";for(let s=0;s<e.length;s++){showsName=e[s].show.name,showsImage=e[s].show.image,showId=e[s].show.id;let t="";t=void 0===favorites.find(e=>e===showId)?"":"favorite",null===showsImage?resultList.innerHTML+=`<li data-id="${showId}" class="js-list-item ${t}"><div class="js-list-div"><h2 class="js-showName">${showsName}</h2><img class= "js-image" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"/></div></li>`:(showsImageMedium=e[s].show.image.medium,resultList.innerHTML+=`<li data-id="${showId}" class="js-list-item ${t}"><div class="js-list-div"><h2 class="js-showName">${showsName}</h2><img class="js-image" src="${showsImageMedium}"/></div></li>`)}addListenerToCards()}function handleClik(){conectToApi()}if(searchButton.addEventListener("click",handleClik),null!==localStorage.getItem("favorites")){const e=JSON.parse(localStorage.getItem("favorites")),s=JSON.parse(localStorage.getItem("globalData"));for(const t of e){const e=s.find(e=>e.show.id===t);null===e.show.image?favoriteList.innerHTML+=`<li data-id="${e.show.id}" class="list-fav"><div class="div-fav"><h1 class="title-fav">${e.show.name}</h1><img class="img-fav" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"/><i data-id="${e.show.id}" class="fas fa-times-circle remove-fav"></i></div></li>`:favoriteList.innerHTML+=`<li data-id="${e.show.id}" class="list-fav"><div class="div-fav"><h1 class="title-fav">${e.show.name}</h1><img class="img-fav" src="${e.show.image.medium}"/><i data-id="${e.show.id}" class="fas fa-times-circle remove-fav"></i></div></li>`}addListenerToIcon()}const inputShow=document.querySelector(".js-searchInput");let filteredShows=[];function addListenerToCards(){const e=document.querySelectorAll(".js-list-item");for(const s of e)s.addEventListener("click",handleClickCard)}function handleClickCard(e){const s=e.currentTarget.dataset.id;void 0===favorites.find(e=>e===parseInt(s))?favorites.push(parseInt(s)):favorites=favorites.filter(e=>e!==parseInt(s)),localStorage.setItem("favorites",JSON.stringify(favorites)),printFavoriteList(e),renderFilteredShows()}function printFavoriteList(e){if(void 0!==e){const s=e.currentTarget.dataset.id,t=e.srcElement.innerText,a=e.srcElement.nextSibling.currentSrc;favoriteList.innerHTML+=`<li data-id="${s}" class="list-fav"><div class="div-fav"><h1 class="title-fav">${t}</h1><img class="img-fav" src="${a}"/><i data-id="${s}" class="fas fa-times-circle remove-fav"></i></div></li>`,console.log(favoriteList)}}function renderFilteredShows(){const e=inputShow.value.toLowerCase();for(const s of globalData)filteredShows=globalData.filter(s=>s.show.name.toLowerCase().includes(e));printShows(filteredShows)}function addListenerToIcon(){const e=document.querySelectorAll(".remove-fav");for(const s of e)s.addEventListener("click",handleClickRemoveFav)}function handleClickRemoveFav(e){console.log(e.target);const s=JSON.parse(localStorage.getItem("favorites")),t=JSON.parse(localStorage.getItem("globalData"));console.log(s),console.log(t)}